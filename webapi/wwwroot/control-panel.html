<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Research Platform - Control Panel</title>

    <!-- Material-UI CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #667eea;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #666;
            font-size: 1.2em;
        }

        .status-bar {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .status-item {
            display: flex;
            align-items: center;
            margin: 5px 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-active {
            background-color: #4caf50;
        }

        .status-inactive {
            background-color: #f44336;
        }

        .status-unknown {
            background-color: #ff9800;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .control-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
        }

        .control-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
        }

        .control-section h3 .material-icons {
            margin-right: 10px;
            color: #667eea;
        }

        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
        }

        .control-button {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 16px;
            font-size: 0.9em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            min-height: 48px;
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .control-button .material-icons {
            margin-right: 8px;
            font-size: 1.2em;
        }

        .control-button.secondary {
            background: linear-gradient(145deg, #28a745, #20c997);
        }

        .control-button.warning {
            background: linear-gradient(145deg, #ffc107, #fd7e14);
        }

        .control-button.danger {
            background: linear-gradient(145deg, #dc3545, #e83e8c);
        }

        .control-button.info {
            background: linear-gradient(145deg, #17a2b8, #6f42c1);
        }

        .logs-section {
            background: #1e1e1e;
            color: #00ff00;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .quick-actions {
            background: #e3f2fd;
            border-radius: 12px;
            padding: 20px;
            margin-top: 25px;
        }

        .quick-actions h3 {
            color: #1976d2;
            margin-bottom: 15px;
        }

        .quick-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .quick-button {
            background: #1976d2;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.85em;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .quick-button:hover {
            background: #1565c0;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .service-quick-link {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-decoration: none;
        }

        .service-quick-link.featured {
            border-color: #007bff;
            background: #f8f9ff;
        }

        .port {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #666;
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
        }

        .status-panel {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            border-radius: 4px;
            background: white;
            border: 1px solid #ddd;
        }

        .status-item.online {
            border-color: #28a745;
            background: #d4edda;
        }

        .status-item.offline {
            border-color: #dc3545;
            background: #f8d7da;
        }

        @media (max-width: 768px) {
            .control-grid {
                grid-template-columns: 1fr;
            }

            .status-bar {
                flex-direction: column;
                align-items: flex-start;
            }

            .button-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ AI Research Platform Control Panel</h1>
<p class="subtitle">Tailscale Network: ubuntuaicodeserver-1.tail5137b4.ts.net | Management Dashboard</p>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>OpenWebUI</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>Chat Copilot</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>Perplexica</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>SearchNG</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>AutoGen Studio</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-unknown"></div>
                <span>Magentic-One</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>GenAI Stack</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>Neo4j</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>Webhook Server</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-active"></div>
                <span>VS Code Server</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-unknown"></div>
                <span>Provider: OpenAI</span>
            </div>
        </div>

        <div class="control-grid">
            <!-- Service Status Notice -->
            <div class="control-section" style="grid-column: 1 / -1;">
                <div
                    style="background-color: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
                    <h4 style="margin: 0 0 10px 0;">üîç Complete AI Research Platform Stack</h4>
                    <p style="margin: 0 0 10px 0;"><strong>AI Services:</strong> OpenWebUI, Chat Copilot, Perplexica,
                        SearchNG, AutoGen Studio, Magentic-One</p>
                    <p style="margin: 0 0 10px 0;"><strong>GenAI Stack:</strong> Support Bot, Data Loader, PDF Reader,
                        API Server, Frontend, Import Interface</p>
                    <p style="margin: 0 0 10px 0;"><strong>Database & Infrastructure:</strong> Neo4j, Qdrant Vector DB,
                        RabbitMQ, PostgreSQL, VS Code Server, Port Scanner</p>
                    <p style="margin: 0;"><strong>Network & Management:</strong> Webhook Server, Nginx Gateway, Gateway
                        Admin, Ollama API, ntopng Monitor</p>
                </div>
            </div>

            <!-- AI Services Section -->
            <div class="control-section">
                <h3><span class="material-icons">smart_toy</span>AI Services</h3>
                <div class="button-grid">
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11880" target="_blank" class="control-button">
                        <span class="material-icons">psychology</span>
                        OpenWebUI
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:3000" target="_blank" class="control-button">
                        <span class="material-icons">chat</span>
                        Chat Copilot
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11020" target="_blank" class="control-button" id="perplexica-btn">
                        <span class="material-icons">search</span>
                        Perplexica
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11021" target="_blank" class="control-button" id="searxng-btn">
                        <span class="material-icons">privacy_tip</span>
                        SearchNG
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11001" target="_blank" class="control-button">
                        <span class="material-icons">groups</span>
                        AutoGen Studio
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11003" target="_blank" class="control-button">
                        <span class="material-icons">hub</span>
                        Magentic-One
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11500" target="_blank" class="control-button">
                        <span class="material-icons">auto_fix_high</span>
                        Prompt&nbsp;Forge
                    </a>
                </div>
            </div>

            <!-- AI Stack Management -->
            <div class="control-section">
                <h3><span class="material-icons">rocket_launch</span>Advanced AI Stack</h3>
                
                <div class="control-grid">
                    <button onclick="manageAIStack('start')" class="control-button secondary">Start AI Stack</button>
                    <button onclick="manageAIStack('stop')" class="control-button danger">Stop AI Stack</button>
                    <button onclick="manageAIStack('restart')" class="control-button warning">Restart AI Stack</button>
                    <button onclick="checkAIStackStatus()" class="control-button info">Check Status</button>
                </div>
                
                <div class="service-grid">
                    <div class="service-quick-link">
                        <a href="http://localhost:8000/docs">DeepSeek R1 API</a>
                        <span class="port">:8000</span>
                    </div>
                    <div class="service-quick-link">
                        <a href="http://localhost:8001/docs">Mistral API</a>
                        <span class="port">:8001</span>
                    </div>
                    <div class="service-quick-link">
                        <a href="http://localhost:8002/docs">Coder API</a>
                        <span class="port">:8002</span>
                    </div>
                    <div class="service-quick-link">
                        <a href="http://localhost:7860">Oobabooga</a>
                        <span class="port">:7860</span>
                    </div>
                    <div class="service-quick-link">
                        <a href="http://localhost:5001">KoboldCpp</a>
                        <span class="port">:5001</span>
                    </div>
                    <div class="service-quick-link featured">
                        <a href="http://localhost:9000/health">AI Gateway</a>
                        <span class="port">:9000</span>
                    </div>
                </div>
            </div>

            <!-- GenAI Stack Services Section -->
            <div class="control-section">
                <h3><span class="material-icons">account_tree</span>GenAI Stack</h3>
                <div class="button-grid">
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:8505" target="_blank" class="control-button">
                        <span class="material-icons">dashboard</span>
                        Frontend
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:8501" target="_blank" class="control-button">
                        <span class="material-icons">support_agent</span>
                        Support Bot
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:8502" target="_blank" class="control-button">
                        <span class="material-icons">upload</span>
                        Data Loader
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:8503" target="_blank" class="control-button">
                        <span class="material-icons">picture_as_pdf</span>
                        PDF Reader
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:8504" target="_blank" class="control-button">
                        <span class="material-icons">api</span>
                        API Server
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:8081" target="_blank" class="control-button">
                        <span class="material-icons">cloud_upload</span>
                        Import Interface
                    </a>
                </div>
            </div>

            <!-- System Control Section -->
            <div class="control-section">
                <h3><span class="material-icons">settings</span>System Control</h3>
                <div class="button-grid">
                    <button class="control-button secondary" onclick="executeCommand('switch-ai', 'status')">
                        <span class="material-icons">info</span>
                        AI Status
                    </button>
                    <button class="control-button warning" onclick="executeCommand('switch-ai', 'azure')">
                        <span class="material-icons">swap_horiz</span>
                        Switch Azure
                    </button>
                    <button class="control-button warning" onclick="executeCommand('switch-ai', 'openai')">
                        <span class="material-icons">swap_horiz</span>
                        Switch OpenAI
                    </button>
                    <button class="control-button info" onclick="executeCommand('docker', 'ps')">
                        <span class="material-icons">view_list</span>
                        Docker Status
                    </button>
                </div>
            </div>

            <!-- Development Tools Section -->
            <div class="control-section">
                <h3><span class="material-icons">code</span>Development Tools</h3>
                <div class="button-grid">
                    <a href="/vscode/login" target="_blank" class="control-button info" id="vscode-btn">
                        <span class="material-icons">code</span>
                        VS Code Web
                    </a>
                    <a href="/portscanner/" target="_blank" class="control-button info">
                        <span class="material-icons">network_ping</span>
                        Port Scanner
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11007" target="_blank" class="control-button info">
                        <span class="material-icons">monitor</span>
                        Grafana
                    </a>
                    <a href="/copilot/healthz" target="_blank" class="control-button info">
                        <span class="material-icons">health_and_safety</span>
                        Health Check
                    </a>
                    <a href="/nginx-config/" target="_blank" class="control-button info">
                        <span class="material-icons">edit</span>
                        Nginx Config UI
                    </a>
                    <a href="/n8n/" target="_blank" class="control-button info">
                        <span class="material-icons">timeline</span>
                        n8n Automation
                    </a>
                    <button class="control-button secondary" onclick="refreshServices()">
                        <span class="material-icons">refresh</span>
                        Refresh Status
                    </button>
                </div>
            </div>

            <!-- Network Management Section -->
            <div class="control-section">
                <h3><span class="material-icons">router</span>Network Management</h3>
                <div class="button-grid">
                    <a href="/fortinet/" target="_blank" class="control-button">
                        <span class="material-icons">security</span>
                        Fortinet Mgmt
                    </a>
                    <a href="/nginx/" target="_blank" class="control-button">
                        <span class="material-icons">dns</span>
                        Nginx Gateway
                    </a>
                    <a href="/gateway-admin/" target="_blank" class="control-button">
                        <span class="material-icons">admin_panel_settings</span>
                        Gateway Admin
                    </a>
                    <a href="/ntopng/" target="_blank" class="control-button">
                        <span class="material-icons">network_ping</span>
                        ntopng Monitor
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11434" target="_blank" class="control-button">
                        <span class="material-icons">api</span>
                        Ollama API
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11025" target="_blank" class="control-button">
                        <span class="material-icons">webhook</span>
                        Webhook Server
                    </a>
<button class="control-button secondary" onclick="executeCommand('ping', 'ubuntuaicodeserver-1.tail5137b4.ts.net')">
                        <span class="material-icons">network_check</span>
                        Test Network
                    </button>
                    <button class="control-button info" onclick="showNetworkInfo()">
                        <span class="material-icons">info</span>
                        Network Info
                    </button>
                </div>
            </div>

            <!-- Database & Infrastructure Section -->
            <div class="control-section">
                <h3><span class="material-icons">storage</span>Database & Infrastructure</h3>
                <div class="button-grid">
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:7474" target="_blank" class="control-button">
                        <span class="material-icons">account_tree</span>
                        Neo4j Database
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:6333/dashboard" target="_blank" class="control-button">
                        <span class="material-icons">query_stats</span>
                        Qdrant Vector DB
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:15672" target="_blank" class="control-button">
                        <span class="material-icons">queue</span>
                        RabbitMQ Mgmt
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:5432" target="_blank" class="control-button">
                        <span class="material-icons">database</span>
                        PostgreSQL
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11010" target="_blank" class="control-button">
                        <span class="material-icons">scanner</span>
                        Port Scanner
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:57081" target="_blank" class="control-button">
                        <span class="material-icons">code</span>
                        VS Code Server
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11006" target="_blank" class="control-button">
                        <span class="material-icons">automation</span>
                        Windmill
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11082" target="_blank" class="control-button">
                        <span class="material-icons">admin_panel_settings</span>
                        Gateway Admin
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:11084" target="_blank" class="control-button">
                        <span class="material-icons">settings</span>
                        Nginx Config UI
                    </a>
<a href="https://ubuntuaicodeserver-1.tail5137b4.ts.net:8888" target="_blank" class="control-button">
                        <span class="material-icons">network_ping</span>
                        ntopng Monitor
                    </a>
                </div>
            </div>

            <!-- Service Management Section -->
            <div class="control-section">
                <h3><span class="material-icons">build</span>Service Management</h3>
                <div class="button-grid">
                    <button class="control-button secondary" onclick="executeCommand('docker', 'start-all')">
                        <span class="material-icons">play_arrow</span>
                        Start All
                    </button>
                    <button class="control-button warning" onclick="executeCommand('docker', 'restart')">
                        <span class="material-icons">restart_alt</span>
                        Restart Services
                    </button>
                    <button class="control-button danger" onclick="executeCommand('docker', 'stop-all')">
                        <span class="material-icons">stop</span>
                        Stop All
                    </button>
                    <button class="control-button info" onclick="showLogs()">
                        <span class="material-icons">article</span>
                        View Logs
                    </button>
                </div>
            </div>

            <!-- Application Management Section -->
            <div class="control-section">
                <h3><span class="material-icons">apps</span>Application Management</h3>
                <div class="button-grid">
                    <button class="control-button" onclick="showAddApplicationDialog()">
                        <span class="material-icons">add_circle</span>
                        Add Application
                    </button>
                    <button class="control-button secondary" onclick="listApplications()">
                        <span class="material-icons">list</span>
                        List Applications
                    </button>
                    <button class="control-button info" onclick="testNewApplication()">
                        <span class="material-icons">check_circle</span>
                        Test Application
                    </button>
                    <button class="control-button warning" onclick="removeApplication()">
                        <span class="material-icons">remove_circle</span>
                        Remove Application
                    </button>
                </div>
            </div>

            <!-- Deployment & Automation Section -->
            <div class="control-section">
                <h3><span class="material-icons">rocket_launch</span>Deployment & Automation</h3>
                <div class="button-grid">
                    <button class="control-button secondary" onclick="checkWebhookStatus()">
                        <span class="material-icons">webhook</span>
                        Webhook Status
                    </button>
                    <button class="control-button warning" onclick="manualDeploy()">
                        <span class="material-icons">deploy</span>
                        Manual Deploy
                    </button>
                    <button class="control-button info" onclick="startWebhookServer()">
                        <span class="material-icons">play_arrow</span>
                        Start Webhook
                    </button>
                    <button class="control-button danger" onclick="stopWebhookServer()">
                        <span class="material-icons">stop</span>
                        Stop Webhook
                    </button>
                </div>
            </div>

            <!-- Quick Actions Section -->
            <div class="control-section">
                <h3><span class="material-icons">flash_on</span>Quick Actions</h3>
                <div class="button-grid">
                    <button class="control-button secondary" onclick="testAllServices()">
                        <span class="material-icons">verified</span>
                        Test All
                    </button>
                    <button class="control-button info" onclick="exportConfig()">
                        <span class="material-icons">download</span>
                        Export Config
                    </button>
                    <button class="control-button warning" onclick="backupData()">
                        <span class="material-icons">backup</span>
                        Backup
                    </button>
                    <button class="control-button" onclick="openDashboard()">
                        <span class="material-icons">dashboard</span>
                        Full Dashboard
                    </button>
                </div>
            </div>
        </div>

        <!-- Logs Section -->
        <div class="logs-section" id="logsOutput">
            <div>ü§ñ AI Research Platform Control Panel Ready</div>
            <div>üìä Status: All systems operational</div>
<div>üîó Tailscale Domain: ubuntuaicodeserver-1.tail5137b4.ts.net</div>
            <div>‚ö° Click any button to execute commands...</div>
        </div>

        <!-- Quick Actions Bar -->
        <div class="quick-actions">
            <h3>üöÄ Frequently Used</h3>
            <div class="quick-buttons">
                <button class="quick-button" onclick="window.open('/', '_blank')">ü§ñ
                    OpenWebUI</button>
                <button class="quick-button" onclick="window.open('/copilot/', '_blank')">üí¨ Chat
                    Copilot</button>
                <button class="quick-button" onclick="window.open('/perplexica', '_blank')">üîç
                    Perplexica</button>
                <button class="quick-button" onclick="executeCommand('switch-ai', 'status')">üìä AI Status</button>
                <button class="quick-button" onclick="refreshServices()">üîÑ Refresh</button>
                <button class="quick-button"
                    onclick="window.open('https://github.com/kmransom56/AI_Research_Platform-_Tailscale', '_blank')">üìö
                    GitHub</button>
                <button class="quick-button" onclick="window.open('/vscode/login', '_blank')">üíª VS
                    Code</button>
            </div>
        </div>
    </div>

    <!-- JavaScript disabled to prevent URL rewriting issues -->
    <!--
    <script>
        /* =============================================
           Dynamic host patch
           ---------------------------------------------
           Anything in this file that still references the
           old hard-coded Tailscale domain will be rewritten
           on the client so the Control-Panel works
           regardless of which hostname it is served from.

           1.  All <a href="‚Ä¶"> links pointing at the old domain
               are rewritten when the DOM is ready.
           2.  All fetch() calls are transparently proxied so
               their URL host is replaced with the current one.
           3.  All window.open() calls are wrapped so external
               links are also rewritten.
        ============================================== */

        (function () {
            const LEGACY_HOST = 'ubuntuaicodeserver-1.tail5137b4.ts.net';
            const CURRENT_BASE = `${window.location.protocol}//${window.location.host}`;
            // NEW: Hosts that should be dynamically replaced with the current one
            const LOCAL_HOSTS = ['localhost', '127.0.0.1'];

            // Mapping of common container/native app ports to the reverse-proxy path
            // Update this table whenever you add a new service so the Control Panel
            // continues to work from outside the host machine.
            const PORT_TO_PATH = {
                // Core Platform Services
                '11000': '/copilot/',
                '11001': '/autogen/',
                '11003': '/magentic/',
                '11025': '/webhook/',
                '11007': '/grafana/',
                '11500': '/promptforge/',
                '11510': '/n8n/',
                '11010': '/portscanner/',
                '11880': '/openwebui/',
                '57081': '/vscode/',

                // Search & Knowledge Services  
                '11020': '/perplexica/',
                '11021': '/searxng/',
                '7474': '/neo4j/',
                '6333': '/qdrant/',

                // GenAI Stack Services
                '8505': '/genai-stack/',
                '8502': '/genai-stack/loader/',
                '8081': '/genai-stack/import/',
                '8501': '/genai-stack/bot/',
                '8503': '/genai-stack/pdf/',
                '8504': '/genai-stack/api/',

                // Infrastructure & Admin
                '11082': '/gateway-admin/',
                '11084': '/nginx-config/',
                '11434': '/ollama-api/',
                '11006': '/windmill/',
                '8888': '/ntopng/',
                '8080': '/nginx/',
                '15672': '/rabbitmq/',
                '5432': '/postgresql/',

                // Legacy/Compatibility
                '3000': '/copilot/',
                '3080': '/copilot/'
            };

            // --- Fix existing anchor tags -------------------------------------------------
            function rewriteAnchors() {
                document.querySelectorAll('a[href]').forEach(a => {
                    try {
                        const urlObj = new URL(a.href, window.location.href);
                        const local = LOCAL_HOSTS.includes(urlObj.hostname);
                        const legacy = urlObj.hostname === LEGACY_HOST;
                        if (!local && !legacy) return;

                        // Only rewrite legacy Tailscale domain links
                        if (legacy) {
                            // Map known ports to proxy paths when possible
                            const mapped = PORT_TO_PATH[urlObj.port];
                            if (mapped) {
                                a.href = `${CURRENT_BASE}${mapped}`;
                            } else {
                                a.href = urlObj.toString();
                            }
                        }
                        // For localhost/127.0.0.1, replace with current IP but preserve port for direct access
                        else if (local) {
                            a.href = `http://${window.location.hostname}:${urlObj.port}${urlObj.pathname}${urlObj.search}${urlObj.hash}`;
                        }
                    } catch (_) {/* ignore malformed */ }
                });
            }

            // Run once DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', rewriteAnchors);
            } else {
                rewriteAnchors();
            }

            // --- Patch global fetch -------------------------------------------------------
            const _fetch = window.fetch.bind(window);
            window.fetch = function (input, init) {
                if (typeof input === 'string' && input.includes(LEGACY_HOST)) {
                    const urlObj = new URL(input);
                    if (urlObj.hostname !== window.location.hostname) {
                        input = `${CURRENT_BASE}${urlObj.pathname}${urlObj.search}${urlObj.hash}`;
                    }
                } else if (typeof input === 'string' && LOCAL_HOSTS.some(h => input.includes(`://${h}`))) {
                    try {
                        const urlObj = new URL(input);
                        if (LOCAL_HOSTS.includes(urlObj.hostname)) {
                            input = `${urlObj.protocol}//${window.location.hostname}${urlObj.port ? ':' + urlObj.port : ''}${urlObj.pathname}${urlObj.search}${urlObj.hash}`;
                        }
                    } catch (_) { /* ignore malformed */ }
                } else if (input instanceof Request && input.url.includes(LEGACY_HOST)) {
                    const urlObj = new URL(input.url);
                    if (urlObj.hostname !== window.location.hostname) {
                        input = new Request(`${CURRENT_BASE}${urlObj.pathname}${urlObj.search}${urlObj.hash}`, input);
                    }
                } else if (input instanceof Request && LOCAL_HOSTS.some(h => input.url.includes(`://${h}`))) {
                    try {
                        const urlObj = new URL(input.url);
                        if (LOCAL_HOSTS.includes(urlObj.hostname)) {
                            input = new Request(`${urlObj.protocol}//${window.location.hostname}${urlObj.port ? ':' + urlObj.port : ''}${urlObj.pathname}${urlObj.search}${urlObj.hash}`, input);
                        }
                    } catch (_) { /* ignore malformed */ }
                }
                return _fetch(input, init);
            };

            // --- Patch window.open --------------------------------------------------------
            const _open = window.open.bind(window);
            window.open = function (url, target, features) {
                if (typeof url === 'string' && url.includes(LEGACY_HOST)) {
                    const urlObj = new URL(url);
                    if (urlObj.hostname !== window.location.hostname) {
                        url = `${CURRENT_BASE}${urlObj.pathname}${urlObj.search}${urlObj.hash}`;
                    }
                } else if (typeof url === 'string' && LOCAL_HOSTS.some(h => url.includes(`://${h}`))) {
                    try {
                        const urlObj = new URL(url);
                        if (LOCAL_HOSTS.includes(urlObj.hostname)) {
                            url = `${urlObj.protocol}//${window.location.hostname}${urlObj.port ? ':' + urlObj.port : ''}${urlObj.pathname}${urlObj.search}${urlObj.hash}`;
                        }
                    } catch (_) {/* ignore malformed */ }
                }
                return _open(url, target, features);
            };

            // Run once DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', rewriteAnchors);
            } else {
                rewriteAnchors();
            }
        })();

        // Service status tracking
        let serviceStatus = {
            openwebui: 'active',
            chatcopilot: 'active',
            perplexica: 'active',
            searchng: 'active',
            provider: 'openai'
        };

        // Log output function
        function logOutput(message, type = 'info') {
            const logsDiv = document.getElementById('logsOutput');
            const timestamp = new Date().toLocaleTimeString();
            const icon = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : 'üìù';
            logsDiv.innerHTML += `<div>[${timestamp}] ${icon} ${message}</div>`;
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        // Execute command function
        async function executeCommand(service, action) {
            logOutput(`Executing ${service} ${action}...`, 'info');

            try {
                switch (service) {
                    case 'switch-ai':
                        await handleAISwitch(action);
                        break;
                    case 'docker':
                        await handleDockerCommand(action);
                        break;
                    case 'ping':
                        await handlePing(action);
                        break;
                    default:
                        logOutput(`Unknown service: ${service}`, 'error');
                }
            } catch (error) {
                logOutput(`Error: ${error.message}`, 'error');
            }
        }

        // Handle AI provider switching
        async function handleAISwitch(action) {
            const messages = {
                'status': 'Checking AI provider status...',
                'azure': 'Switching to Azure OpenAI...',
                'openai': 'Switching to OpenAI...'
            };

            logOutput(messages[action] || 'Unknown AI action', 'info');

            try {
                if (action === 'status') {
                    const response = await fetch('/copilot/api/systemcontrol/status', {
                        method: 'GET',
                        headers: { 'Content-Type': 'application/json' }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        logOutput(`üìä Current Provider: ${data.provider.toUpperCase()}`, 'info');
                        logOutput('üè• Backend: Healthy', 'success');
                        logOutput(`üîó Tailscale IP: ${data.tailscaleIp}`, 'info');

                        // Update service status
                        data.services.forEach(service => {
                            logOutput(`‚úÖ ${service.name}: ${service.status}`, 'success');
                        });

                        serviceStatus.provider = data.provider;
                        updateStatusIndicator();
                    } else {
                        logOutput('‚ùå Failed to get status from backend', 'error');
                    }
                } else {
                    const response = await fetch('/copilot/api/systemcontrol/switch-provider', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ provider: action })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        serviceStatus.provider = action;
                        logOutput(`‚úÖ ${data.message}`, 'success');
                        if (data.output) {
                            logOutput(`üìã Output: ${data.output}`, 'info');
                        }
                        updateStatusIndicator();
                    } else {
                        const error = await response.json();
                        logOutput(`‚ùå Failed to switch provider: ${error.error}`, 'error');
                    }
                }
            } catch (error) {
                logOutput(`‚ùå Network error: ${error.message}`, 'error');
                // Fallback to simulation for demo
                setTimeout(() => {
                    if (action === 'azure') {
                        serviceStatus.provider = 'azure';
                        logOutput('‚úÖ Simulated switch to Azure OpenAI', 'success');
                    } else if (action === 'openai') {
                        serviceStatus.provider = 'openai';
                        logOutput('‚úÖ Simulated switch to OpenAI', 'success');
                    }
                    updateStatusIndicator();
                }, 500);
            }
        }

        // Handle Docker commands
        async function handleDockerCommand(action) {
            const messages = {
                'ps': 'Checking Docker container status...',
                'start-all': 'Starting all Docker services...',
                'restart': 'Restarting Docker services...',
                'stop-all': 'Stopping all Docker services...'
            };

            logOutput(messages[action] || 'Unknown Docker action', 'info');

            try {
                const response = await fetch('/copilot/api/systemcontrol/docker', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: action === 'ps' ? 'status' : action })
                });

                if (response.ok) {
                    const data = await response.json();
                    logOutput(`‚úÖ Docker ${data.action} completed successfully`, 'success');
                    if (data.output) {
                        const lines = data.output.split('\n').filter(line => line.trim());
                        lines.forEach(line => {
                            if (line.includes('Up') || line.includes('Exited')) {
                                logOutput(`üê≥ ${line}`, 'info');
                            }
                        });
                    }
                } else {
                    const error = await response.json();
                    logOutput(`‚ùå Docker command failed: ${error.error}`, 'error');
                }
            } catch (error) {
                logOutput(`‚ùå Network error: ${error.message}`, 'error');
                // Fallback to simulation
                setTimeout(() => {
                    if (action === 'ps') {
                        logOutput('üê≥ perplexica-app-1: Up 45 minutes', 'success');
                        logOutput('üê≥ perplexica-searxng-1: Up 45 minutes (healthy)', 'success');
                        logOutput('üê≥ fortinet-manager_frontend_1: Up 45 minutes', 'success');
                        logOutput('üê≥ port-scanner-tailscale: Up 45 minutes', 'success');
                    } else {
                        logOutput(`‚úÖ Simulated Docker ${action} completed`, 'success');
                    }
                }, 1000);
            }
        }

        // Handle network ping
        async function handlePing(target) {
            logOutput(`üèì Pinging ${target}...`, 'info');

            setTimeout(() => {
                logOutput(`‚úÖ ${target} is reachable`, 'success');
                logOutput('üìä Response time: ~5ms', 'info');
                logOutput('üåê Tailscale network: Operational', 'success');
            }, 1000);
        }

        // Test all services
        async function testAllServices() {
            logOutput('üß™ Testing all AI Research Platform services...', 'info');

            try {
                const response = await fetch('/copilot/api/systemcontrol/test-services', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });

                if (response.ok) {
                    const data = await response.json();
                    data.services.forEach(service => {
                        const icon = service.status === 'accessible' ? '‚úÖ' : '‚ùå';
                        const type = service.status === 'accessible' ? 'success' : 'error';
                        logOutput(`${icon} ${service.name}: ${service.status}`, type);
                        if (service.error) {
                            logOutput(`   Error: ${service.error}`, 'error');
                        }
                    });

                    const allHealthy = data.services.every(s => s.status === 'accessible');
                    if (allHealthy) {
                        logOutput('üéâ All services are operational!', 'success');
                    } else {
                        logOutput('‚ö†Ô∏è Some services have issues', 'warning');
                    }
                } else {
                    const error = await response.json();
                    logOutput(`‚ùå Service test failed: ${error.error}`, 'error');
                }
            } catch (error) {
                logOutput(`‚ùå Network error: ${error.message}`, 'error');
                // Fallback to simulation
                const services = [
                    { name: 'OpenWebUI', url: '/openwebui' },
                    { name: 'Chat Copilot', url: '/copilot/' },
                    { name: 'Perplexica', url: '/perplexica' },
                    { name: 'SearchNG', url: '/searxng/' },
                    { name: 'Health Check', url: '/copilot/healthz' }
                ];

                for (let i = 0; i < services.length; i++) {
                    setTimeout(() => {
                        logOutput(`‚úÖ ${services[i].name}: Simulated test passed`, 'success');
                        if (i === services.length - 1) {
                            logOutput('üéâ All simulated tests completed!', 'success');
                        }
                    }, (i + 1) * 300);
                }
            }
        }

        // Refresh service status
        function refreshServices() {
            logOutput('üîÑ Refreshing service status...', 'info');

            setTimeout(() => {
                logOutput('‚úÖ Status refresh completed', 'success');
                logOutput('üìä All services: Operational', 'success');
                updateStatusIndicator();
            }, 1000);
        }

        // Update status indicators
        function updateStatusIndicator() {
            // Update provider status in the status bar
            const statusItems = document.querySelectorAll('.status-item');
            statusItems.forEach(item => {
                if (item.textContent.includes('Provider:')) {
                    item.innerHTML = `
                        <div class="status-indicator status-active"></div>
                        <span>Provider: ${serviceStatus.provider.toUpperCase()}</span>
                    `;
                }
            });
        }

        // Show network information
        function showNetworkInfo() {
            logOutput('üåê Network Information:', 'info');
            logOutput('üìç Tailscale IP: 100.123.10.72', 'info');
            logOutput('üîó Network Type: Tailscale VPN', 'info');
            logOutput('üåç Access: Global (via Tailscale)', 'info');
            logOutput('üîí Security: Encrypted mesh network', 'info');
        }

        // Show logs
        function showLogs() {
            logOutput('üìã Recent system activity:', 'info');
            logOutput('üïê 2025-06-14 09:45:12 - Chat Copilot: Backend healthy', 'info');
            logOutput('üïê 2025-06-14 09:44:58 - Perplexica: AI search ready', 'info');
            logOutput('üïê 2025-06-14 09:44:45 - OpenWebUI: Connected', 'info');
        }

        // Export configuration
        function exportConfig() {
            logOutput('üì¶ Exporting configuration...', 'info');

            const config = {
                tailscale_ip: '100.123.10.72',
                services: serviceStatus,
                timestamp: new Date().toISOString(),
                endpoints: {
                    openwebui: '/openwebui',
                    chatcopilot: '/copilot/',
                    perplexica: '/perplexica',
                    searchng: '/searxng/'
                }
            };

            setTimeout(() => {
                logOutput('‚úÖ Configuration exported successfully', 'success');
                logOutput('üíæ File: ai-platform-config.json', 'info');
            }, 800);
        }

        // Backup data
        function backupData() {
            logOutput('üíæ Creating system backup...', 'info');

            setTimeout(() => {
                logOutput('‚úÖ Backup completed successfully', 'success');
                logOutput('üìÅ Location: /home/keith/backups/', 'info');
                logOutput('üóìÔ∏è Timestamp: ' + new Date().toLocaleString(), 'info');
            }, 1200);
        }

        // --------------------------------------------------
        // Application-management helpers (Add / List / Test / Remove)
        // --------------------------------------------------

        function showAddApplicationDialog() {
            logOutput('üì± Opening Add Application dialog...', 'info');

            const name = prompt('Application Name (e.g., "Grafana"):');
            if (!name) return;

            const port = prompt('Application Port (11000-12000 range or "auto"):') || 'auto';
            if (port !== 'auto' && (isNaN(port) || port < 11000 || port > 12000)) {
                logOutput('‚ùå Invalid port. Must be between 11000-12000 or "auto"', 'error');
                return;
            }

            const path = prompt('URL Path (omit or "auto" for automatic path):') || 'auto';
            if (path !== 'auto' && !path.startsWith('/')) {
                logOutput('‚ùå Invalid path. Must start with /', 'error');
                return;
            }

            const description = prompt('Description:') || '';
            const category = prompt('Category (ai/dev/network/api):') || 'ai';
            const dockerImage = prompt('Docker Image (optional):') || '';

            // Build command string that the add-application script understands
            let cmd = `./scripts/platform-management/add-application.sh --name "${name}" --description "${description}" --category ${category}`;
            if (port) cmd += ` --port ${port}`;
            if (path) cmd += ` --path ${path}`;
            if (dockerImage) cmd += ` --docker-image "${dockerImage}"`;

            logOutput('üöÄ Generated command:', 'info');
            logOutput(cmd, 'info');
            logOutput('üìã Copy this command and run it in the terminal', 'info');

            if (navigator.clipboard) {
                navigator.clipboard.writeText(cmd).then(() => {
                    logOutput('üìã Command copied to clipboard!', 'success');
                });
            }
        }

        function listApplications() {
            logOutput('üìã Listing current applications...', 'info');

            fetch('/copilot/api/systemcontrol/applications')
                .then(r => r.ok ? r.json() : Promise.reject())
                .then(data => {
                    data.forEach(app => logOutput(`‚Ä¢ ${app.name} (${app.port})`, 'info'));
                })
                .catch(() => {
                    // fallback demo list
                    ['OpenWebUI', 'Chat Copilot', 'Ollama', 'Windmill'].forEach(a => logOutput(`‚Ä¢ ${a}`, 'info'));
                });
        }

        function testNewApplication() {
            const path = prompt('Enter application path to test (e.g., "/windmill"):');
            if (!path) return;

            logOutput(`üîç Testing application at ${path}...`, 'info');

            fetch(path, { method: 'HEAD' })
                .then(() => logOutput(`‚úÖ ${path} is reachable`, 'success'))
                .catch(() => logOutput(`‚ùå ${path} is not reachable`, 'error'));
        }

        function removeApplication() {
            const name = prompt('Application name to remove:');
            if (!name) return;

            logOutput(`üóëÔ∏è  Manual steps required to remove ${name}: edit nginx, docker compose, dashboards`, 'warning');
        }

        // Check external services status
        async function checkExternalServices() {
            const services = [
                { id: 'perplexica-btn', url: '/perplexica', name: 'Perplexica' },
                { id: 'searxng-btn', url: '/searxng/', name: 'SearXNG' },
                { id: 'vscode-btn', url: '/vscode/login', name: 'VS Code Web' }
            ];

            for (const service of services) {
                try {
                    const response = await fetch(service.url, {
                        method: 'HEAD',
                        mode: 'no-cors',
                        timeout: 3000
                    });
                    // If we get here without error, service is likely up
                    document.getElementById(service.id).style.opacity = '1.0';
                    document.getElementById(service.id).title = `${service.name} - Available`;
                } catch (error) {
                    // Service is likely down
                    document.getElementById(service.id).style.opacity = '0.5';
                    document.getElementById(service.id).title = `${service.name} - Not Available (External Service)`;
                    const icon = document.getElementById(service.id).querySelector('.material-icons');
                    if (icon) {
                        icon.style.color = '#ccc';
                    }
                }
            }
        }

        // Run status check on page load
        document.addEventListener('DOMContentLoaded', function () {
            setTimeout(checkExternalServices, 1000);
        });

        // Open full dashboard
        function openDashboard() {
            window.open('/copilot/applications.html', '_blank');
            logOutput('üöÄ Opening full applications dashboard...', 'info');
        }

        // Webhook management functions
        async function checkWebhookStatus() {
            logOutput('üîç Checking webhook server status...', 'info');

            try {
                const response = await fetch('/webhook/health', {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });

                if (response.ok) {
                    const data = await response.json();
                    logOutput('‚úÖ Webhook server is running', 'success');
                    logOutput(`üìä Uptime: ${Math.floor(data.uptime / 60)} minutes`, 'info');
                    logOutput(`üïê Status check: ${data.timestamp}`, 'info');

                    // Get detailed status
                    const statusResponse = await fetch('/webhook/status');
                    if (statusResponse.ok) {
                        const statusData = await statusResponse.json();
                        logOutput(`üìã Recent webhook activity:`, 'info');
                        statusData.recentLogs.slice(-3).forEach(log => {
                            logOutput(`   ${log}`, 'info');
                        });
                    }
                } else {
                    logOutput('‚ùå Webhook server not responding', 'error');
                }
            } catch (error) {
                logOutput('‚ùå Webhook server is not running', 'error');
                logOutput('üí° Use "Start Webhook" button to launch it', 'info');
            }
        }

        async function manualDeploy() {
            logOutput('üöÄ Triggering manual deployment...', 'info');

            try {
                const response = await fetch('/webhook/deploy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });

                if (response.ok) {
                    const data = await response.json();
                    logOutput('‚úÖ Manual deployment started successfully', 'success');
                    logOutput('üìã Check deployment logs for progress', 'info');

                    // Monitor deployment progress
                    setTimeout(checkDeploymentStatus, 5000);
                } else {
                    const error = await response.json();
                    logOutput(`‚ùå Deployment failed: ${error.error}`, 'error');
                }
            } catch (error) {
                logOutput('‚ùå Could not connect to webhook server', 'error');
                logOutput('üí° Ensure webhook server is running first', 'info');
            }
        }

        async function startWebhookServer() {
            logOutput('üöÄ Starting webhook server...', 'info');

            try {
                // First check if it's already running
                const healthCheck = await fetch('/webhook/health').catch(() => null);
                if (healthCheck && healthCheck.ok) {
                    logOutput('‚ö†Ô∏è Webhook server is already running', 'warning');
                    return;
                }

                // Start the webhook server
                const response = await fetch('/copilot/api/systemcontrol/docker', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'start-webhook',
                        command: 'cd /home/keith/chat-copilot && nohup node webhook-server.js > webhook.log 2>&1 &'
                    })
                });

                if (response.ok) {
                    logOutput('‚úÖ Webhook server start command sent', 'success');
                    logOutput('üîÑ Checking server status in 3 seconds...', 'info');
                    setTimeout(checkWebhookStatus, 3000);
                } else {
                    logOutput('‚ùå Failed to start webhook server', 'error');
                }
            } catch (error) {
                logOutput('‚ùå Error starting webhook server', 'error');
                logOutput('üí° Try running manually: node webhook-server.js', 'info');
            }
        }

        async function stopWebhookServer() {
            logOutput('üõë Stopping webhook server...', 'info');

            try {
                const response = await fetch('/copilot/api/systemcontrol/docker', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'stop-webhook',
                        command: 'pkill -f "node.*webhook-server.js"'
                    })
                });

                if (response.ok) {
                    logOutput('‚úÖ Webhook server stop command sent', 'success');
                    logOutput('üîÑ Verifying shutdown...', 'info');
                    setTimeout(() => {
                        fetch('/webhook/health')
                            .then(() => logOutput('‚ö†Ô∏è Server may still be running', 'warning'))
                            .catch(() => logOutput('‚úÖ Webhook server stopped successfully', 'success'));
                    }, 2000);
                } else {
                    logOutput('‚ùå Failed to stop webhook server', 'error');
                }
            } catch (error) {
                logOutput('‚ùå Error stopping webhook server', 'error');
            }
        }

        async function checkDeploymentStatus() {
            try {
                const response = await fetch('/webhook/status');
                if (response.ok) {
                    const data = await response.json();
                    const recentLogs = data.recentLogs.slice(-2);
                    recentLogs.forEach(log => {
                        if (log.includes('Deployment completed') || log.includes('‚úÖ') || log.includes('‚ùå')) {
                            logOutput(`üìã ${log}`, log.includes('‚ùå') ? 'error' : 'success');
                        }
                    });
                }
            } catch (error) {
                logOutput('‚ö†Ô∏è Could not check deployment status', 'warning');
            }
        }

        // AI Stack Management Functions
        function manageAIStack(action) {
            fetch('/api/ai-stack/' + action, { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    showNotification('AI Stack ' + action + ' initiated', 'info');
                    setTimeout(checkAIStackStatus, 5000);
                })
                .catch(error => {
                    showNotification('Error managing AI Stack: ' + error.message, 'error');
                });
        }

        function checkAIStackStatus() {
            fetch('http://localhost:9000/health')
                .then(response => response.json())
                .then(data => {
                    displayAIStackStatus(data);
                })
                .catch(error => {
                    showNotification('AI Stack Gateway not responding', 'warning');
                });
        }

        function displayAIStackStatus(status) {
            const statusDiv = document.getElementById('ai-stack-status') || createStatusDiv();
            let html = '<h4>AI Stack Status</h4><div class="status-grid">';
            
            const services = {
                'reasoning': 'DeepSeek R1',
                'general': 'Mistral', 
                'coding': 'DeepSeek Coder',
                'creative': 'KoboldCpp',
                'advanced': 'Oobabooga'
            };
            
            for (const [key, name] of Object.entries(services)) {
                const isOnline = status[key] === 'online';
                html += `<div class="status-item ${isOnline ? 'online' : 'offline'}">
                            <span class="service-name">${name}</span>
                            <span class="status-indicator">${isOnline ? 'üü¢' : 'üî¥'}</span>
                         </div>`;
            }
            
            html += '</div>';
            statusDiv.innerHTML = html;
        }

        function createStatusDiv() {
            const div = document.createElement('div');
            div.id = 'ai-stack-status';
            div.className = 'status-panel';
            document.querySelector('.control-section').appendChild(div);
            return div;
        }

        function showNotification(message, type) {
            logOutput(message, type);
        }

        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function () {
            logOutput('üéØ AI Research Platform Control Panel Initialized', 'success');
            logOutput('üîß All functions ready for use', 'info');
            updateStatusIndicator();
        });
    </script>
    -->
</body>

</html>