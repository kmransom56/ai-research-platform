# Chat Copilot Platform - Portability and Synchronization Guide\n\n## 🎯 Overview\n\nThis guide covers the enhanced portability features and rsync synchronization capabilities of the Chat Copilot platform, enabling seamless deployment and synchronization across multiple computers and environments.\n\n## 🚀 Quick Start\n\n### 1. Enhance Portability\n\n```bash\n# Run the portability enhancement script\n./scripts/setup/enhance-portability.sh\n\n# This will:\n# - Detect your system configuration\n# - Create portable environment templates\n# - Fix hard-coded paths\n# - Generate deployment-ready configurations\n```\n\n### 2. Configure Environment\n\n```bash\n# Copy the portable template\ncp .env.portable.template .env\n\n# Edit with your specific configuration\nnano .env\n```\n\n### 3. Setup Rsync Synchronization\n\n```bash\n# Configure rsync targets\n./scripts/sync/rsync-platform.sh setup\n\n# Edit the configuration\nnano scripts/sync/rsync-config.conf\n```\n\n### 4. Start Platform\n\n```bash\n# Start with portable configuration\n./start-platform-portable.sh\n\n# Or start with specific profile\n./start-platform-portable.sh development\n```\n\n## 🔧 Portability Features\n\n### System Detection\n\nThe platform automatically detects:\n- Operating system (Linux, macOS, Windows)\n- Distribution and version\n- Architecture (x86_64, arm64, etc.)\n- Available memory and disk space\n- Network configuration\n- Docker availability\n- Current user and permissions\n\n### Environment-Based Configuration\n\nAll configuration is now environment-variable based:\n\n```bash\n# System configuration\nPLATFORM_ROOT=/path/to/installation\nPLATFORM_USER=username\nPLATFORM_IP=192.168.1.100\n\n# Service ports\nCHAT_COPILOT_BACKEND_PORT=11000\nOPENWEBUI_PORT=11880\nPERPLEXICA_PORT=11003\n\n# Database configuration\nPOSTGRES_PASSWORD=secure-password\nREDIS_PASSWORD=secure-password\n\n# AI provider configuration\nOPENAI_API_KEY=your-api-key\nAZURE_OPENAI_ENDPOINT=your-endpoint\n```\n\n### Cross-Platform Compatibility\n\n- **Linux**: Full support for all distributions\n- **macOS**: Native Docker support\n- **Windows**: WSL2 and Docker Desktop support\n- **ARM64**: Support for Apple Silicon and ARM servers\n\n### Deployment Profiles\n\n```bash\n# Core services only\n./start-platform-portable.sh\n\n# Development environment\n./start-platform-portable.sh development\n\n# Production environment\n./start-platform-portable.sh production\n\n# Monitoring enabled\n./start-platform-portable.sh monitoring\n\n# Everything enabled\n./start-platform-portable.sh full\n```\n\n## 🔄 Rsync Synchronization\n\n### Configuration\n\nThe rsync system supports multiple targets:\n\n```bash\n# Predefined targets\nDEV_SERVER=\"user@dev.example.com:/opt/chat-copilot\"\nSTAGING_SERVER=\"user@staging.example.com:/opt/chat-copilot\"\nPROD_SERVER=\"user@prod.example.com:/opt/chat-copilot\"\nBACKUP_SERVER=\"user@backup.example.com:/backups/chat-copilot\"\n\n# SSH keys for each target\nSSH_KEY_DEV=\"$HOME/.ssh/id_rsa\"\nSSH_KEY_PROD=\"$HOME/.ssh/id_rsa_prod\"\n```\n\n### Basic Operations\n\n#### Push Changes\n\n```bash\n# Push to development server\n./scripts/sync/rsync-platform.sh push dev-server\n\n# Push to production (with dry run first)\n./scripts/sync/rsync-platform.sh push prod-server --dry-run\n./scripts/sync/rsync-platform.sh push prod-server\n\n# Push excluding data directories\n./scripts/sync/rsync-platform.sh push staging-server --exclude-data\n```\n\n#### Pull Changes\n\n```bash\n# Pull from development server\n./scripts/sync/rsync-platform.sh pull dev-server\n\n# Pull with compression\n./scripts/sync/rsync-platform.sh pull prod-server --compress\n```\n\n#### Bidirectional Sync\n\n```bash\n# Sync with conflict detection\n./scripts/sync/rsync-platform.sh sync dev-server\n\n# Dry run to see what would change\n./scripts/sync/rsync-platform.sh sync staging-server --dry-run\n```\n\n#### Backup and Restore\n\n```bash\n# Create backup on remote server\n./scripts/sync/rsync-platform.sh backup prod-server\n\n# Check sync status\n./scripts/sync/rsync-platform.sh status dev-server\n```\n\n### Advanced Options\n\n```bash\n# Exclude data directories (databases, uploads)\n--exclude-data\n\n# Include secret files (.env, keys)\n--include-secrets\n\n# Use compression for transfer\n--compress\n\n# Delete files on destination that don't exist in source\n--delete\n\n# Verbose output\n--verbose\n\n# Dry run (show what would be transferred)\n--dry-run\n\n# Custom configuration file\n--config /path/to/custom-config.conf\n```\n\n### Custom Targets\n\n```bash\n# Sync to custom target\n./scripts/sync/rsync-platform.sh push user@192.168.1.100:/opt/chat-copilot\n\n# With options\n./scripts/sync/rsync-platform.sh push user@server.com:/apps/chat-copilot --compress --exclude-data\n```\n\n## 🛠️ Setup Instructions\n\n### 1. Initial Setup\n\n```bash\n# Clone or download the platform\ngit clone https://github.com/your-repo/chat-copilot.git\ncd chat-copilot\n\n# Enhance portability\n./scripts/setup/enhance-portability.sh\n\n# Configure environment\ncp .env.portable.template .env\nnano .env\n```\n\n### 2. SSH Key Setup\n\n```bash\n# Generate SSH key if needed\nssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa\n\n# Copy public key to remote servers\nssh-copy-id user@dev-server.com\nssh-copy-id user@prod-server.com\n\n# Test connections\nssh user@dev-server.com\n```\n\n### 3. Rsync Configuration\n\n```bash\n# Setup rsync configuration\n./scripts/sync/rsync-platform.sh setup\n\n# Edit configuration file\nnano scripts/sync/rsync-config.conf\n\n# Test connections\n./scripts/sync/rsync-platform.sh test dev-server\n./scripts/sync/rsync-platform.sh test prod-server\n```\n\n### 4. First Deployment\n\n```bash\n# Start platform locally\n./start-platform-portable.sh\n\n# Push to development server\n./scripts/sync/rsync-platform.sh push dev-server --exclude-data\n\n# SSH to remote server and start\nssh user@dev-server.com\ncd /opt/chat-copilot\n./start-platform-portable.sh production\n```\n\n## 📋 Environment Variables Reference\n\n### System Configuration\n\n| Variable | Description | Default |\n|----------|-------------|----------|\n| `PLATFORM_ROOT` | Installation directory | Auto-detected |\n| `PLATFORM_USER` | User for file ownership | Current user |\n| `PLATFORM_GROUP` | Group for file ownership | Current group |\n| `PLATFORM_IP` | Server IP address | Auto-detected |\n| `PLATFORM_OS` | Operating system | Auto-detected |\n| `PLATFORM_ARCH` | System architecture | Auto-detected |\n\n### Network Configuration\n\n| Variable | Description | Default |\n|----------|-------------|----------|\n| `PLATFORM_DOMAIN` | Domain name | localhost |\n| `PLATFORM_PROTOCOL` | HTTP/HTTPS | http |\n| `PLATFORM_PORT` | Main port | 3000 |\n\n### Service Ports\n\n| Variable | Description | Default |\n|----------|-------------|----------|\n| `CHAT_COPILOT_BACKEND_PORT` | Backend API port | 11000 |\n| `CHAT_COPILOT_FRONTEND_PORT` | Frontend port | 3000 |\n| `OPENWEBUI_PORT` | OpenWebUI port | 11880 |\n| `PERPLEXICA_PORT` | Perplexica port | 11003 |\n| `SEARXNG_PORT` | SearXNG port | 11004 |\n| `VSCODE_PORT` | VS Code port | 57081 |\n| `GRAFANA_PORT` | Grafana port | 11007 |\n| `PROMETHEUS_PORT` | Prometheus port | 11008 |\n\n### Database Configuration\n\n| Variable | Description | Default |\n|----------|-------------|----------|\n| `POSTGRES_HOST` | PostgreSQL host | postgres |\n| `POSTGRES_PORT` | PostgreSQL port | 5432 |\n| `POSTGRES_DB` | Database name | chatcopilot |\n| `POSTGRES_USER` | Database user | postgres |\n| `POSTGRES_PASSWORD` | Database password | Generated |\n| `REDIS_HOST` | Redis host | redis |\n| `REDIS_PORT` | Redis port | 6379 |\n| `REDIS_PASSWORD` | Redis password | Generated |\n\n### AI Provider Configuration\n\n| Variable | Description | Default |\n|----------|-------------|----------|\n| `OPENAI_API_KEY` | OpenAI API key | Required |\n| `OPENAI_MODEL` | OpenAI model | gpt-4 |\n| `AZURE_OPENAI_ENDPOINT` | Azure OpenAI endpoint | Optional |\n| `AZURE_OPENAI_API_KEY` | Azure OpenAI key | Optional |\n| `ANTHROPIC_API_KEY` | Anthropic API key | Optional |\n| `OLLAMA_HOST` | Ollama host | ollama |\n| `OLLAMA_PORT` | Ollama port | 11434 |\n\n## 🔒 Security Considerations\n\n### Environment File Security\n\n```bash\n# Secure the .env file\nchmod 600 .env\nchown $USER:$USER .env\n\n# Never commit .env to version control\necho \".env\" >> .gitignore\n```\n\n### SSH Key Management\n\n```bash\n# Use different keys for different environments\nSSH_KEY_DEV=\"$HOME/.ssh/id_rsa_dev\"\nSSH_KEY_PROD=\"$HOME/.ssh/id_rsa_prod\"\n\n# Restrict key permissions\nchmod 600 ~/.ssh/id_rsa*\n```\n\n### Secret Exclusion\n\nBy default, rsync excludes secret files:\n\n```bash\n# Excluded by default\n.env\n.env.production\nsecrets/\n*.key\n*.pem\n*.crt\n\n# Include only when explicitly requested\n./scripts/sync/rsync-platform.sh push prod-server --include-secrets\n```\n\n## 🚨 Troubleshooting\n\n### Common Issues\n\n#### Permission Denied\n\n```bash\n# Fix file ownership\nsudo chown -R $USER:$USER /path/to/chat-copilot\n\n# Fix SSH key permissions\nchmod 600 ~/.ssh/id_rsa\nchmod 644 ~/.ssh/id_rsa.pub\n```\n\n#### Port Conflicts\n\n```bash\n# Check what's using a port\nsudo lsof -i :11000\n\n# Change port in .env file\nCHAT_COPILOT_BACKEND_PORT=11001\n```\n\n#### Docker Issues\n\n```bash\n# Check Docker status\ndocker info\n\n# Restart Docker service\nsudo systemctl restart docker\n\n# Clean up Docker\ndocker system prune -a\n```\n\n#### Rsync Connection Issues\n\n```bash\n# Test SSH connection\nssh -i ~/.ssh/id_rsa user@remote-server\n\n# Test rsync manually\nrsync -avz --dry-run ./ user@remote-server:/path/\n\n# Check SSH agent\nssh-add -l\nssh-add ~/.ssh/id_rsa\n```\n\n### Debugging\n\n```bash\n# Enable verbose logging\n./scripts/sync/rsync-platform.sh push dev-server --verbose\n\n# Check logs\ntail -f logs/sync/rsync-dev-server-*.log\n\n# Test system detection\n./scripts/setup/detect-system.sh\n```\n\n## 📊 Monitoring and Maintenance\n\n### Health Checks\n\n```bash\n# Check service status\ndocker ps --format \"table {{.Names}}\\t{{.Status}}\\t{{.Ports}}\"\n\n# Test endpoints\ncurl http://localhost:11000/healthz\ncurl http://localhost:11880/health\n\n# Check sync status\n./scripts/sync/rsync-platform.sh status dev-server\n```\n\n### Automated Backups\n\n```bash\n# Setup cron job for daily backups\ncrontab -e\n\n# Add line for daily backup at 2 AM\n0 2 * * * /path/to/chat-copilot/scripts/sync/rsync-platform.sh backup backup-server\n```\n\n### Log Management\n\n```bash\n# View sync logs\nls -la logs/sync/\n\n# Monitor real-time logs\ntail -f logs/sync/rsync-*.log\n\n# Rotate logs\nfind logs/sync/ -name \"*.log\" -mtime +30 -delete\n```\n\n## 🌐 Multi-Environment Workflows\n\n### Development Workflow\n\n```bash\n# 1. Develop locally\n./start-platform-portable.sh development\n\n# 2. Test changes\ncurl http://localhost:11000/api/test\n\n# 3. Push to development server\n./scripts/sync/rsync-platform.sh push dev-server --exclude-data\n\n# 4. Test on development server\nssh user@dev-server.com \"cd /opt/chat-copilot && ./start-platform-portable.sh\"\n```\n\n### Staging Workflow\n\n```bash\n# 1. Pull from development\n./scripts/sync/rsync-platform.sh pull dev-server\n\n# 2. Test locally\n./start-platform-portable.sh\n\n# 3. Push to staging\n./scripts/sync/rsync-platform.sh push staging-server\n\n# 4. Deploy on staging\nssh user@staging-server.com \"cd /opt/chat-copilot && ./start-platform-portable.sh production\"\n```\n\n### Production Deployment\n\n```bash\n# 1. Create backup\n./scripts/sync/rsync-platform.sh backup prod-server\n\n# 2. Dry run deployment\n./scripts/sync/rsync-platform.sh push prod-server --dry-run --exclude-data\n\n# 3. Deploy to production\n./scripts/sync/rsync-platform.sh push prod-server --exclude-data\n\n# 4. Restart production services\nssh user@prod-server.com \"cd /opt/chat-copilot && docker-compose restart\"\n```\n\n## 📚 Additional Resources\n\n- [Docker Documentation](https://docs.docker.com/)\n- [Rsync Manual](https://rsync.samba.org/documentation.html)\n- [SSH Key Management](https://www.ssh.com/academy/ssh/keygen)\n- [Environment Variables Best Practices](https://12factor.net/config)\n- [Chat Copilot Documentation](./README.md)\n\n## 🤝 Contributing\n\nTo contribute to the portability and sync features:\n\n1. Test on different operating systems\n2. Report compatibility issues\n3. Suggest improvements to the sync process\n4. Update documentation\n5. Add support for new deployment targets\n\n---\n\n**Your Chat Copilot platform is now fully portable and sync-ready! 🚀**"